<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>WhatsApp Embedded Signup</title>
  <style>
    body { font-family: sans-serif; padding: 1rem; }
    button {
      background-color: #1877f2;
      border: none;
      border-radius: 4px;
      color: #fff;
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
      height: 40px;
      padding: 0 24px;
    }
  </style>
  <script async defer crossorigin="anonymous"
    src="https://connect.facebook.net/en_US/sdk.js">
  </script>
</head>
<body>
  <h2>WhatsApp Embedded Signup</h2>
  <button id="launch-btn">Connect WhatsApp</button>

  <script>
    // wrapper for RN postMessage
    function postToReactNative(payload) {
      window.ReactNativeWebView.postMessage(JSON.stringify(payload));
    }

    window.fbAsyncInit = function() {
      FB.init({
        appId            : '523707793850383',
        version          : 'v23.0',
        xfbml            : false,
        autoLogAppEvents : true
      });
    };

      window.addEventListener('message', function(event) {
        console.log(event, 'event=============>')
      try {
        const data = JSON.parse(event.data);
        if (data.type === 'WA_EMBEDDED_SIGNUP') {
            console.log(data, 'data================>')
       
          postToReactNative(data);
        }
      } catch (e) {
        console.log('[embed] Non-JSON message or not relevant', event.data);
      }
    })

    function fbLoginCallback(response) {
      if (response.authResponse && response.authResponse.code) {
        // **This** is the only time we ever post back to RN:
        // postToReactNative({
        //   success: true,
        //   waba_id:   response.authResponse.business_id,        // example field
        //   phone_number_id: response.authResponse.phone_number_id,
        //   token: response.authResponse.access_token            // the “exchangeable token”
        // });
      } else {
        // postToReactNative({ success: false, error: response });
      }
    }

    document.getElementById('launch-btn')
      .addEventListener('click', () => {
        FB.login(fbLoginCallback, {
          config_id                     : '683389464136204',
          response_type                 : 'code',
          override_default_response_type: true,
        });
      });
  </script>
</body>
</html>
